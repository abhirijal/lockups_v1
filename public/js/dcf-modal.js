define(["exports","./dcf-utility"],function(t,h){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.DCFModal=void 0;var e=function(){function d(t,e){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.modals=t,this.currentModal=null,this.currentBtn=null,this.body=document.querySelector("body"),this.nonModals=[];var t=document.getElementById("dcf-skip-nav"),n=document.getElementById("dcf-header"),i=document.getElementById("dcf-main"),o=document.getElementById("dcf-footer");t&&this.nonModals.push(t),n&&this.nonModals.push(n),i&&this.nonModals.push(i),o&&this.nonModals.push(o),this.disableBodyScroll=null,this.enableBodyScroll=null,e&&e.disableBodyScroll&&e.enableBodyScroll&&(this.disableBodyScroll=e.disableBodyScroll,this.enableBodyScroll=e.enableBodyScroll)}var t,e,n;return t=d,(e=[{key:"appendToBody",value:function(t){this.body.appendChild(t)}},{key:"toggleModal",value:function(t,e){"false"===document.getElementById(t).getAttribute("aria-hidden")?this.closeModal(t):this.openModal(t,e)}},{key:"setNavToggleBtnState",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"open",n=t.getElementsByTagName("svg"),i=t.getElementsByClassName("dcf-nav-toggle-label");n.length&&(n=n[h.DCFUtility.magicNumbers("int0")].getElementsByTagName("g"),Array.from(n).forEach(function(t){t.classList.contains("dcf-nav-toggle-icon-open")?"open"===e.toLowerCase()?t.classList.remove("dcf-d-none"):t.classList.add("dcf-d-none"):t.classList.contains("dcf-nav-toggle-icon-close")&&("open"===e.toLowerCase()?t.classList.add("dcf-d-none"):t.classList.remove("dcf-d-none"))})),i.length&&("open"===e.toLowerCase()?i[h.DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-open")?t.getAttribute("data-nav-toggle-label-open"):"Open":i[h.DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-closed")?t.getAttribute("data-nav-toggle-label-closed"):"Close")}},{key:"openModal",value:function(e,t){var i,n,o=this,d=document.getElementById("dcf-nav-toggle-group"),a=d&&d.parentElement?d.parentElement:null,l=(this.modals.forEach(function(t){t.getAttribute("id")!==e&&o.closeModal(t.getAttribute("id"))}),document.getElementById(e)),s="false"===l.getAttribute("aria-hidden"),c=!1;t&&(this.currentBtn=t,t=document.getElementById(t),(c=t&&"true"===t.getAttribute("data-with-nav-toggle-group"))&&this.setNavToggleBtnState(t,"closed")),this.currentModal=e,s||(t="ModalPreOpenEvent_".concat(e),document.dispatchEvent(new CustomEvent(t)),this.nonModals.forEach(function(t){c&&d&&t===a?(t.setAttribute("aria-hidden","false"),a.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&(t===d?t.setAttribute("aria-hidden","false"):t.setAttribute("aria-hidden","true"))})):t.setAttribute("aria-hidden","true")}),this.disableBodyScroll&&this.disableBodyScroll(l,{allowTouchMove:function(t){for(var e=t;e&&e!==document.body;){if(e.classList.contains("dcf-modal-content"))return Object.assign(document.body.style,{WebkitOverflowScrolling:"none",overflow:"hidden"}),!0;e.parentElement&&(e=e.parentElement)}return!1}}),this.body.classList.add("dcf-modal-is-open"),l.setAttribute("aria-hidden","false"),l.classList.remove("dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),l.classList.add("dcf-opacity-100","dcf-pointer-events-auto"),c&&l.classList.add("dcf-z-modal-behind-nav-toggle-group"),l.focus(),i=l.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])'),l.addEventListener("keydown",n=function(t){var e=i[h.DCFUtility.magicNumbers("int0")],n=i[i.length-h.DCFUtility.magicNumbers("int1")];"Tab"!==t.key&&9!==t.keyCode||("Tab"!==t.key&&9!==t.keyCode||(t.shiftKey?document.activeElement===l?(t.preventDefault(),e.focus()):document.activeElement===e&&(t.preventDefault(),n.focus()):document.activeElement===n&&(t.preventDefault(),e.focus())))}),document.addEventListener("ModalCloseEvent_".concat(e),function(){l.removeEventListener("keydown",n)}),s="ModalOpenEvent_".concat(e),document.dispatchEvent(new CustomEvent(s)))}},{key:"closeModal",value:function(t){var e=document.getElementById("dcf-nav-toggle-group"),n=e&&e.parentElement?e.parentElement:null,i=document.getElementById(t),o="true"===i.getAttribute("aria-hidden");this.currentModal=null,o||(this.body.classList.remove("dcf-modal-is-open"),!this.currentBtn||(o=document.getElementById(this.currentBtn))&&"true"===o.getAttribute("data-with-nav-toggle-group")&&this.setNavToggleBtnState(o,"open"),this.nonModals.forEach(function(t){e&&t===n&&n.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&t.setAttribute("aria-hidden","false")}),t.setAttribute("aria-hidden","false")}),i.setAttribute("aria-hidden","true"),i.classList.remove("dcf-opacity-100","dcf-pointer-events-auto","dcf-z-modal-behind-nav-toggle-group"),i.classList.add("dcf-opacity-0","dcf-pointer-events-none"),i.addEventListener("transitionend",function t(){i.removeEventListener("transitionend",t),i.classList.contains("dcf-invisible")||i.classList.add("dcf-invisible")}),this.currentBtn&&document.getElementById(this.currentBtn).focus(),this.enableBodyScroll&&this.enableBodyScroll(i),o="ModalCloseEvent_".concat(t),document.dispatchEvent(new CustomEvent(o)))}},{key:"btnToggleListen",value:function(t,e,n){var i=this;t.addEventListener("click",function(){i.toggleModal(e,n)},!1)}},{key:"btnCloseListen",value:function(t,e){var n=this;t.addEventListener("click",function(){n.closeModal(e.getAttribute("id"))},!1)}},{key:"overlayListen",value:function(e,n){var i=this;e.addEventListener("click",function(t){n.contains(t.target)||i.closeModal(e.getAttribute("id"))})}},{key:"escListen",value:function(){var e=this;document.addEventListener("keydown",function(t){h.DCFUtility.isKeyEvent(t,h.DCFUtility.keyEvents("escape"))&&e.currentModal&&(t.preventDefault(),e.closeModal(e.currentModal))})}},{key:"initialize",value:function(){var i=this;if(this.modals){var t=document.querySelectorAll(".dcf-btn-toggle-modal"),e=document.querySelectorAll(".dcf-btn-close-modal"),r=document.querySelectorAll(".dcf-modal-wrapper"),u=document.querySelectorAll(".dcf-modal-content"),f=document.querySelectorAll(".dcf-modal-header");t.forEach(function(t){var e=t.getAttribute("data-toggles-modal"),n=h.DCFUtility.uuidv4();t.setAttribute("id",n),t.removeAttribute("disabled"),i.btnToggleListen(t,e,n)});for(var n=0;n<this.modals.length;n++){var o=this.modals[n],d=r[n],a=u[n],l=f[n],s=e[n],c=o.id,c="".concat(c,"-heading");l.querySelectorAll("h1, h2, h3, h4, h5, h6")[h.DCFUtility.magicNumbers("int0")].id=c,this.appendToBody(o),o.removeAttribute("hidden"),o.setAttribute("aria-labelledby",c),o.setAttribute("aria-hidden","true"),o.setAttribute("role","dialog"),o.setAttribute("tabindex","-1"),o.classList.length===h.DCFUtility.magicNumbers("int1")&&o.classList.contains("dcf-modal")&&o.classList.add("dcf-bg-overlay-dark"),o.classList.add("dcf-fixed","dcf-pin-top","dcf-pin-left","dcf-h-100%","dcf-w-100%","dcf-d-flex","dcf-ai-center","dcf-jc-center","dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),d.setAttribute("role","document"),d.classList.length===h.DCFUtility.magicNumbers("int1")&&d.classList.contains("dcf-modal-wrapper")&&d.classList.add("dcf-relative","dcf-h-auto","dcf-overflow-y-auto"),l.classList.length===h.DCFUtility.magicNumbers("int1")&&l.classList.contains("dcf-modal-header")&&l.classList.add("dcf-wrapper","dcf-pt-8","dcf-sticky","dcf-pin-top"),s.classList.length===h.DCFUtility.magicNumbers("int1")&&s.classList.contains("dcf-btn-close-modal")&&s.classList.add("dcf-btn","dcf-btn-tertiary","dcf-absolute","dcf-pin-top","dcf-pin-right","dcf-z-1"),a.classList.length===h.DCFUtility.magicNumbers("int1")&&a.classList.contains("dcf-modal-content")&&a.classList.add("dcf-wrapper","dcf-pb-8"),s.setAttribute("type","button"),s.setAttribute("aria-label","Close"),this.escListen(),this.overlayListen(o,d),this.btnCloseListen(s,o)}}}}])&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),d}();t.DCFModal=e});